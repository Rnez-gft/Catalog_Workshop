<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ProductController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">catalogServiceWorkshop</a> &gt; <a href="index.source.html" class="el_package">com.gftworkshopcatalog.controllers</a> &gt; <span class="el_source">ProductController.java</span></div><h1>ProductController.java</h1><pre class="source lang-java linenums">package com.gftworkshopcatalog.controllers;

import com.gftworkshopcatalog.exceptions.ErrorResponse;
import com.gftworkshopcatalog.services.impl.ProductServiceImpl;
import jakarta.persistence.EntityNotFoundException;
import lombok.Generated;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;
import com.gftworkshopcatalog.model.ProductEntity;

import org.springframework.http.HttpStatus;
import io.swagger.v3.oas.annotations.Operation;
import io.swagger.v3.oas.annotations.responses.ApiResponse;
import io.swagger.v3.oas.annotations.responses.ApiResponses;
import io.swagger.v3.oas.annotations.media.Content;
import io.swagger.v3.oas.annotations.media.Schema;
import io.swagger.v3.oas.annotations.Parameter;
import io.swagger.v3.oas.annotations.tags.Tag;

@RestController
@RequestMapping(&quot;/products&quot;)
@Tag(name = &quot;Products&quot;, description = &quot;Everything about the products&quot;)
public class ProductController {

    private ProductServiceImpl productServiceImpl;

    public ProductController(ProductServiceImpl productServiceImpl) {
<span class="fc" id="L28">        super();</span>
<span class="fc" id="L29">        this.productServiceImpl = productServiceImpl;</span>
<span class="fc" id="L30">    }</span>

    @GetMapping
    @Operation(summary = &quot;List all products&quot;, description = &quot;Returns a list of all products.&quot;)
    @ApiResponses(value = {
            @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Product list&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ProductEntity.class)) }),
            @ApiResponse(responseCode = &quot;500&quot;, description = &quot;Error response&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ErrorResponse.class)) })
    })
    public ResponseEntity&lt;?&gt; listAllProducts() {
        try {
<span class="fc" id="L42">            return ResponseEntity.ok(productServiceImpl.findAllProducts());</span>
<span class="fc" id="L43">        } catch (Exception  ex) {</span>
<span class="fc" id="L44">            ErrorResponse errorResponse = new ErrorResponse(&quot;Internal Server Error&quot;, 500);</span>
<span class="fc" id="L45">            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(errorResponse);</span>

        }
    }

    @PostMapping
    @Operation(summary = &quot;Add a new product&quot;, description = &quot;Creates a new product in the catalog.&quot;)
    @ApiResponses(value = {
            @ApiResponse(responseCode = &quot;201&quot;, description = &quot;Product created&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ProductEntity.class)) }),
            @ApiResponse(responseCode = &quot;400&quot;, description = &quot;Bad request&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ErrorResponse.class)) }),
            @ApiResponse(responseCode = &quot;500&quot;, description = &quot;Error response&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ErrorResponse.class)) })
    })
    public ResponseEntity&lt;?&gt; addNewProduct(@RequestBody ProductEntity productEntity) {
        try {
<span class="fc" id="L62">            ProductEntity createdProductEntity = productServiceImpl.addProduct(productEntity);</span>
<span class="fc" id="L63">            return new ResponseEntity&lt;&gt;(createdProductEntity, HttpStatus.CREATED);</span>
<span class="fc" id="L64">        } catch (IllegalArgumentException ex) {</span>
<span class="fc" id="L65">            ErrorResponse errorResponse = new ErrorResponse(&quot;Bad request&quot;, 400);</span>
<span class="fc" id="L66">            return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(errorResponse);</span>
<span class="fc" id="L67">        } catch (Exception  ex) {</span>
<span class="fc" id="L68">            ErrorResponse errorResponse = new ErrorResponse(&quot;Internal Server Error&quot;, 500);</span>
<span class="fc" id="L69">            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(errorResponse);</span>

        }
    }

    @GetMapping(&quot;/{id}&quot;)
    @Operation(summary = &quot;Get product details&quot;, description = &quot;Returns details of a specific product.&quot;)
    @ApiResponses(value = {
            @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Product details&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;,schema = @Schema(implementation = ProductEntity.class)) }),
            @ApiResponse(responseCode = &quot;404&quot;, description = &quot;Product not found&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ErrorResponse.class)) }),
            @ApiResponse(responseCode = &quot;500&quot;, description = &quot;Error response&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;,schema = @Schema(implementation = ErrorResponse.class)) })
    })
    public ResponseEntity&lt;?&gt; getProductDetails(
            @Parameter(description = &quot;Product ID&quot;, required = true)
            @PathVariable(&quot;id&quot;) long productId) {
        try {
<span class="fc" id="L88">            ProductEntity productEntity = productServiceImpl.findProductById(productId);</span>
<span class="fc" id="L89">            return ResponseEntity.ok(productEntity);</span>
<span class="fc" id="L90">        } catch (EntityNotFoundException ex) {</span>
<span class="fc" id="L91">            ErrorResponse errorResponse = new ErrorResponse(&quot;Product not found&quot;, 404);</span>
<span class="fc" id="L92">            return ResponseEntity.status(HttpStatus.NOT_FOUND).body(errorResponse);</span>
<span class="fc" id="L93">        } catch (Exception ex) {</span>
<span class="fc" id="L94">            ErrorResponse errorResponse = new ErrorResponse(&quot;Internal server error&quot;, 500);</span>
<span class="fc" id="L95">            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(errorResponse);</span>

        }
    }

    @PutMapping(&quot;/{id}&quot;)
    @Operation(summary = &quot;Update a product&quot;, description = &quot;Updates the details of a specific product.&quot;)
    @ApiResponses(value = {
            @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Product updated&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ProductEntity.class)) }),
            @ApiResponse(responseCode = &quot;404&quot;, description = &quot;Product not found&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ErrorResponse.class)) }),
            @ApiResponse(responseCode = &quot;500&quot;, description = &quot;Error response&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ErrorResponse.class)) })
    })
    public ResponseEntity&lt;?&gt; updateProduct(
            @Parameter(description = &quot;Product ID&quot;, required = true)
            @PathVariable(&quot;id&quot;) Long productId,
            @RequestBody ProductEntity productEntity) {

        try {
<span class="fc" id="L116">            ProductEntity updatedProductEntity = productServiceImpl.updateProduct(productId, productEntity);</span>
<span class="fc" id="L117">            return ResponseEntity.ok(updatedProductEntity);</span>
<span class="fc" id="L118">        } catch (EntityNotFoundException ex) {</span>
<span class="fc" id="L119">            ErrorResponse errorResponse = new ErrorResponse(&quot;Product not found&quot;, 404);</span>
<span class="fc" id="L120">            return ResponseEntity.status(HttpStatus.NOT_FOUND).body(errorResponse);</span>
<span class="fc" id="L121">        } catch (Exception  ex) {</span>
<span class="fc" id="L122">            ErrorResponse errorResponse = new ErrorResponse(&quot;Internal Server Error&quot;, 500);</span>
<span class="fc" id="L123">            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(errorResponse);</span>

        }

    }

    @DeleteMapping(&quot;/{id}&quot;)
    @Operation(summary = &quot;Delete a product&quot;, description = &quot;Deletes a specific product from the catalog.&quot;)
    @ApiResponses(value = {
            @ApiResponse(responseCode = &quot;204&quot;, description = &quot;Product deleted&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = SuccessResponse.class)) }),
            @ApiResponse(responseCode = &quot;404&quot;, description = &quot;Product not found&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ErrorResponse.class)) }),
            @ApiResponse(responseCode = &quot;500&quot;, description = &quot;Error response&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ErrorResponse.class)) })
    })
    public ResponseEntity&lt;?&gt; deleteProduct(
            @Parameter(description = &quot;Product ID&quot;, required = true)
            @PathVariable(&quot;id&quot;) long productId) {
        try {
<span class="fc" id="L143">            productServiceImpl.deleteProduct(productId);</span>
<span class="fc" id="L144">            return ResponseEntity.noContent().build();</span>
<span class="fc" id="L145">        } catch (EntityNotFoundException ex) {</span>
<span class="fc" id="L146">            ErrorResponse errorResponse = new ErrorResponse(&quot;Product not found&quot;, 404);</span>
<span class="fc" id="L147">            return ResponseEntity.status(HttpStatus.NOT_FOUND).body(errorResponse);</span>
<span class="fc" id="L148">        } catch (Exception  ex) {</span>
<span class="fc" id="L149">            ErrorResponse errorResponse = new ErrorResponse(&quot;Internal Server Error&quot;, 500);</span>
<span class="fc" id="L150">            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(errorResponse);</span>


        }
    }


    @PatchMapping(&quot;/{productId}/price&quot;)
    @Operation(summary = &quot;Update the price of a product&quot;, description = &quot;Partially updates the price of a specific product.&quot;)
    @ApiResponses(value = {
            @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Price successfully updated&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ProductEntity.class)) }),
            @ApiResponse(responseCode = &quot;404&quot;, description = &quot;Product not found&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ErrorResponse.class)) }),
            @ApiResponse(responseCode = &quot;500&quot;, description = &quot;Error response&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ErrorResponse.class)) })
    })
    public ResponseEntity&lt;?&gt; updateProductPrice(@PathVariable(&quot;productId&quot;) long productId, @RequestParam(&quot;newPrice&quot;) double newPrice) {
        try {
<span class="fc" id="L169">            ProductEntity updatedProductEntity = productServiceImpl.updateProductPrice(productId, newPrice);</span>
<span class="fc" id="L170">            return ResponseEntity.ok(updatedProductEntity);</span>
<span class="fc" id="L171">        } catch (EntityNotFoundException ex) {</span>
<span class="fc" id="L172">            ErrorResponse errorResponse = new ErrorResponse(&quot;Product not found&quot;, 404);</span>
<span class="fc" id="L173">            return ResponseEntity.status(HttpStatus.NOT_FOUND).body(errorResponse);</span>
<span class="fc" id="L174">        } catch (Exception e) {</span>
<span class="fc" id="L175">            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(&quot;Error updating product price: &quot; + e.getMessage());</span>
        }
    }

    @PatchMapping(&quot;/{productId}/stock&quot;)
    @Operation(summary = &quot;Update the stock of a product&quot;, description = &quot;Partially updates the stock of a specific product.&quot;)
    @ApiResponses(value = {
            @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Stock successfully updated&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ProductEntity.class)) }),
            @ApiResponse(responseCode = &quot;404&quot;, description = &quot;Product not found&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ErrorResponse.class)) }),
            @ApiResponse(responseCode = &quot;500&quot;, description = &quot;Error response&quot;,
                    content = { @Content(mediaType = &quot;application/json&quot;, schema = @Schema(implementation = ErrorResponse.class)) })
    })
    public ResponseEntity&lt;?&gt; updateProductStock(@PathVariable(&quot;productId&quot;) long productId, @RequestParam(&quot;newStock&quot;) int newStock) {
        try {
<span class="fc" id="L191">            ProductEntity updatedProductEntity = productServiceImpl.updateProductStock(productId, newStock);</span>
<span class="fc" id="L192">            return ResponseEntity.ok(updatedProductEntity);</span>
<span class="fc" id="L193">        } catch (EntityNotFoundException ex) {</span>
<span class="fc" id="L194">            ErrorResponse errorResponse = new ErrorResponse(&quot;Product not found&quot;, 404);</span>
<span class="fc" id="L195">            return ResponseEntity.status(HttpStatus.NOT_FOUND).body(errorResponse);</span>
<span class="fc" id="L196">        } catch (Exception e) {</span>
<span class="fc" id="L197">            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(&quot;Error updating product price: &quot; + e.getMessage());</span>
        }
    }

@Generated
    public class SuccessResponse {
        private String message;

        public SuccessResponse(String message) {
            this.message = message;
        }

        public String getMessage() {
            return message;
        }

        public void setMessage(String message) {
            this.message = message;
        }
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>